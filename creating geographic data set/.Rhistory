systemcost_high = 0, laborcost_low = 0, laborcost_high = 0,
jobsupplycost_low = 0, jobsupplycost_high = 0, equipmentallowance_low = 0,
equipmentallowance_high = 0)
i <- 1
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://ashp.neep.org/#!/product/25971")
webElem <- remDr$findElement(by = "css", value = ".col-md-7")
webElem <- remDr$findElement(using = "css", value = ".col-md-7")
webElem$getElementText()
webElem <- remDr$findElement(using = "css", value = ".col-md-5")
webElem$getElementText()
webElem <- remDr$findElement(using = "css", value = ".product_title")
webElem$getElementText()
webElem <- remDr$findElement(using = "css", value = ".product_title")$getElementText()
webElem <- remDr$findElement(using = "css", value = ".ng-binding")$getElementText()
remDr$findElement(using = "css", value = ".ng-binding")$getElementText()
remDr$findElement(using = "css", value = "td")$getElementText()
webElem <- remDr$findElement(using = "css", value = "td")
webElem$getTitle()
remDr$getTitle()
webElem$getTitle()
webElem <- remDr$findElement(using = "css", value = "tr")
webElem
remDr$findElement(using = "css", value = "tr")$getElementText()
remDr$findElement(using = "css", value = "tr2")$getElementText()
remDr$findElement(using = "css", value = "#r0")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(4)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(1)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(2)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(3)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(4)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(5)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(6)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(7)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(2)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(1)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(2)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(3)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(3) td")$getElementText()
remDr$findElement(using = "css", value = ".ng-binding+ td")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(1)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(2)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(3)")$getElementText()
remDr$findElement(using = "css", value = "td:nth-child(4)")$getElementText()
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(4)")$getElementText()
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(1)")$getElementText()
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(2)")$getElementText()
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(3)")$getElementText()
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(4)")$getElementText()
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(5)")$getElementText()
#second section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(2) td:nth-child(5)")$getElementText()
#second section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(5)")$getElementText()
#third section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) td:nth-child(5)")$getElementText()
#third section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) td:nth-child(5)")$getElementText()
#fifth section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(6) td:nth-child(5)")$getElementText()
#fourth section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) td:nth-child(5)")$getElementText()
#first section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(2) td:nth-child(5)")$getElementText()
#second section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(5)")$getElementText()
#first section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(2) td:nth-child(6)")$getElementText()
#second section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(6)")$getElementText()
#third section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) td:nth-child(6)")$getElementText()
#fourth section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) td:nth-child(6)")$getElementText()
#fifth section
remDr$findElement(using = "css", value = ".ng-scope:nth-child(6) td:nth-child(6)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(2) .ng-binding:nth-child(3) , tr:nth-child(2) td:nth-child(1)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(2) td:nth-child(1)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(23) td:nth-child(1)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(1)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#first section - rated output
remDr$findElement(using = "css", value = "tr:nth-child(2) td:nth-child(6)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(1) td:nth-child(3)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(2) td:nth-child(3)")$getElementText()
#first section
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#first section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(2) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(4)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(1) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(2) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(4) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(1)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(1) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) tr:nth-child(3) td:nth-child(3)")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(2) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(4) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(5) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(2) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(11) th , tr:nth-child(11) .ng-binding")$getElementText()
## SEER
remDr$findElement(using = "css", value = "tr:nth-child(11) .ng-binding")$getElementText()
## SEER
remDr$findElement(using = "css", value = "tr:nth-child(12) .ng-binding")$getElementText()
remDr$navigate("https://ashp.neep.org/#!/product/56995")
remDr$findElement(using = "css", value = "tr:nth-child(3) td")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
## SEER
remDr$findElement(using = "css", value = "tr:nth-child(11) .ng-binding")$getElementText()
## HSPF
remDr$findElement(using = "css", value = "tr:nth-child(12) .ng-binding")$getElementText()
#first section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(2) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#second section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) tr:nth-child(3) td:nth-child(3)")$getElementText()
#third section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) tr:nth-child(3) td:nth-child(3)")$getElementText()
#fourth section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) tr:nth-child(3) td:nth-child(3)")$getElementText()
#fifth section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(6) td:nth-child(6)")$getElementText()
49%%50
50%%50
library(RSelenium)
library(stringr)
library(rvest)
library(dplyr)
wisconsin_zip <- c(53001:54990)
costs <- data.frame(zipcode = 0, totalcost_low = 0, totalcost_high = 0, systemcost_low = 0,
systemcost_high = 0, laborcost_low = 0, laborcost_high = 0,
jobsupplycost_low = 0, jobsupplycost_high = 0, equipmentallowance_low = 0,
equipmentallowance_high = 0)
i <- 1
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 1:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
Sys.sleep(5)
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(1)
#Sys.sleep(5)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
#Sys.sleep(5)
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
#Sys.sleep(5)
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
#Sys.sleep(5)
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
#Sys.sleep(5)
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
#Sys.sleep(5)
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
#Sys.sleep(5)
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) write.csv(costs, "temp.csv", row.names = F)
}
costs
write.csv(costs, "temp.csv", row.names = F)
test <- apply(df,2,as.character)
test <- apply(costs,2,as.character)
View(test)
test <- as.data.frame(apply(costs,2,as.character))
View(test)
write.csv(test, "temp.csv", row.names = F)
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 51:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
Sys.sleep(5)
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(1)
#Sys.sleep(5)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
#Sys.sleep(5)
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
#Sys.sleep(5)
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
#Sys.sleep(5)
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
#Sys.sleep(5)
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
#Sys.sleep(5)
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
#Sys.sleep(5)
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
remDr$close()
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 737:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
Sys.sleep(5)
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(1)
#Sys.sleep(5)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
#Sys.sleep(5)
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
#Sys.sleep(5)
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
#Sys.sleep(5)
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
#Sys.sleep(5)
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
#Sys.sleep(5)
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
#Sys.sleep(5)
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
for(i in 888:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(3)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
for(i in 906:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
View(costs)
for(i in 906:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
test
View(test)
for(i in 1230:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 1230:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "cost to install heat pump - default.csv", row.names = F)
remDr$close()
setwd("~/Documents/GitHub/heatpump-CBA/creating geographic data set")
df <- read.csv("climate_zone_price_regions_and_all_utilities_0.csv")
df <- filter(df, Area.in.Square.Miles > 1)
library(dplyr)
library(stringr)
setwd("~/Documents/GitHub/heatpump-CBA/creating geographic data set")
df <- read.csv("climate_zone_price_regions_and_all_utilities_0.csv")
df <- filter(df, Area.in.Square.Miles > 1)
df <- filter(df, Area.in.Square.Miles > 2)
df <- filter(df, Area.in.Square.Miles > 3)
df <- filter(df, Area.in.Square.Miles > 4)
df <- filter(df, Area.in.Square.Miles > 5)
df <- read.csv("climate_zone_price_regions_and_all_utilities_0.csv")
df <- filter(df, Area.in.Square.Miles > 1)
df <- read.csv("climate_zone_price_regions_and_all_utilities_0.csv")
df <- filter(df, Area.in.Square.Miles > 0.001)
df <- read.csv("climate_zone_price_regions_and_all_utilities_0.csv")
df <- filter(df, Area.in.Square.Miles > 1)
