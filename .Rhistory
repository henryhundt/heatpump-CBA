#the five comes from the fact that heat_COP_low is measured at 5 degrees
ASHP_NG_switchover <- round(((ASHP_NG_switchover_COP - heat_COP_low)/COP_slope) + 5,1)
ASHP_HO_switchover <- round(((ASHP_HO_switchover_COP - heat_COP_low)/COP_slope) + 5,1)
ASHP_P_switchover <- round(((ASHP_P_switchover_COP - heat_COP_low)/COP_slope) + 5,1)
ASHP_ElecRes_switchover <- round(((ASHP_ElecRes_switchover_COP - heat_COP_low)/COP_slope) + 5,1)
ASHP_WoodCord_switchover <- round(((ASHP_WoodCord_switchover_COP - heat_COP_low)/COP_slope) + 5,1)
ASHP_WoodPellet_switchover <- round(((ASHP_WoodPellet_switchover_COP - heat_COP_low)/COP_slope) + 5,1)
## proportion of heating load covered by backup - different for each fuel
## because of different switchovers first adjust the temperature_heating_bin
## data to account for heating load at each temperature bin
heating_bin_hours <- heatingbin_adjust(indoor_design_temperature,
outdoor_design_temperature, temperature_bin_hours)
#next determine the proportion of heating provided by backup for each fuel
ASHP_NG_backup_heating <- backupheatingload(heating_bin_hours, ASHP_NG_switchover, heating_load)
ASHP_HO_backup_heating <- backupheatingload(heating_bin_hours, ASHP_HO_switchover, heating_load)
ASHP_P_backup_heating <- backupheatingload(heating_bin_hours, ASHP_P_switchover, heating_load)
ASHP_ElecRes_backup_heating <- backupheatingload(heating_bin_hours, ASHP_ElecRes_switchover, heating_load)
ASHP_WoodCord_backup_heating <- backupheatingload(heating_bin_hours, ASHP_WoodCord_switchover, heating_load)
ASHP_WoodPellet_backup_heating <- backupheatingload(heating_bin_hours, ASHP_WoodPellet_switchover, heating_load)
## and by ASHP for each fuel
ASHP_NG_heating <- heating_load - ASHP_NG_backup_heating
ASHP_HO_heating <- heating_load - ASHP_HO_backup_heating
ASHP_P_heating <- heating_load - ASHP_P_backup_heating
ASHP_ElecRes_heating <- heating_load - ASHP_ElecRes_backup_heating
ASHP_WoodCord_heating <- heating_load - ASHP_WoodCord_backup_heating
ASHP_WoodPellet_heating <- heating_load - ASHP_WoodPellet_backup_heating
## installment costs
### all values are the mean value of Homewyse estimates of the cost of installing
### each respective piece of technology in the 12 most populous Wisconsin counties.
### the average costs were compared to an average in smaller counties and in all
### instances they were found to be similar for the ASHPs and the ACs, the Homewyse
### "fair cost guide" was used, and the 2 ton 16 SEER option was selected for both,
### with other options left to their default values.
### The costs are split between nonlabor costs (materials) and labor costs since
### we assume that labor costs will covary.
### Note that, following the lead of the RMI's "The Economics of Electrifying
### Buildings" report (https://rmi.org/insight/the-economics-of-electrifying-buildings/)
### we set the costs of the natural gas furnaces and propane furnaces to be
### equal to each other.
### Also, ASHPs and ACs are sized at 2 tons (24K Btus/hour) and the efficiency
### is assumed to be an SEER of 16, while the furnaces which are required to
### meet load at much lower temperatures, are sized at 70K Btus/hour and are
### assumed to be efficient (homewyse essentially allows for an efficient or
### inefficient option for the furnaces).
ASHP_installment_file <- filter(ASHP_installment_file_base, price_region == price_region)[1,]
AC_installment_file <- filter(AC_installment_file_base, price_region == price_region)[1,]
NG_P_installment_file <- filter(NG_P_installment_file_base, price_region == price_region)[1,]
HO_installment_file <- filter(HO_installment_file_base, price_region == price_region)[1,]
ElecRes_installment_file <- filter(ElecRes_installment_file_base, price_region == price_region)[1,]
# nonlabor cost of installing an ASHP in dollars per unit
## we assume nonmaterial costs to covary perfectly
nonmaterial_costs <- runif(1,0,1)
ASHP_installment_cost <- installment_costs(ASHP_installment_file, nonmaterial_costs)
naturalgas_furnace_installment_cost <- installment_costs(NG_P_installment_file, nonmaterial_costs)
heatingoil_furnace_installment_cost <- installment_costs(ASHP_installment_file, nonmaterial_costs)
propane_furnace_installment_cost <- naturalgas_furnace_installment_cost
ElecRes_installment_cost <- installment_costs(ElecRes_installment_file, nonmaterial_costs)
AC_installment_cost <- installment_costs(AC_installment_file, nonmaterial_costs)
# First simulate the efficiency of the "average" air source heat pump in the
# scenario.
# calculate the COP by weighting the COP within each temperature bin by
# how often the ASHP has to run while in that bin and how often that bin
# occurs
# First simulate the efficiency of the "average" air source heat pump in the
# scenario.
# calculate the COP by weighting the COP within each temperature bin by
# how often the ASHP has to run while in that bin and how often that bin
# occurs
ASHP_NG_heating_ASHP_COP <- annual_COP(heat_COP_low, heat_COP_high,
heating_bin_hours, ASHP_NG_switchover, TRUE)
ASHP_HO_heating_ASHP_COP <- annual_COP(heat_COP_low, heat_COP_high,
heating_bin_hours, ASHP_HO_switchover, TRUE)
ASHP_P_heating_ASHP_COP <- annual_COP(heat_COP_low, heat_COP_high,
heating_bin_hours, ASHP_P_switchover, TRUE)
ASHP_ElecRes_heating_ASHP_COP <- annual_COP(heat_COP_low, heat_COP_high,
heating_bin_hours, ASHP_ElecRes_switchover, TRUE)
ASHP_WoodCord_heating_ASHP_COP <- annual_COP(heat_COP_low, heat_COP_high,
heating_bin_hours, ASHP_WoodCord_switchover, TRUE)
ASHP_WoodPellet_heating_ASHP_COP <- annual_COP(heat_COP_low, heat_COP_high,
heating_bin_hours, ASHP_WoodPellet_switchover, TRUE)
#### calculate input for all heating types + cooling
# the rest are all in mmBTUs
ASHP_NG_input <- ASHP_NG_heating/ASHP_NG_heating_ASHP_COP
ASHP_HO_input <- ASHP_HO_heating/ASHP_HO_heating_ASHP_COP
ASHP_P_input <- ASHP_P_heating/ASHP_P_heating_ASHP_COP
ASHP_ElecRes_input <- ASHP_ElecRes_heating/ASHP_ElecRes_heating_ASHP_COP
ASHP_WoodCord_input <- ASHP_WoodCord_heating/ASHP_WoodCord_heating_ASHP_COP
ASHP_WoodPellet_input <- ASHP_WoodPellet_heating/ASHP_WoodPellet_heating_ASHP_COP
backup_NG_input <- ASHP_NG_backup_heating/naturalgas_furnace_efficiency
backup_HO_input <- ASHP_HO_backup_heating/heatingoil_furnace_efficiency
backup_P_input <- ASHP_P_backup_heating/propane_furnace_efficiency
backup_ElecRes_input <- ASHP_ElecRes_backup_heating/ElecRes_efficiency
backup_WoodCord_input <- ASHP_WoodCord_backup_heating/wood_cord_efficiency
backup_WoodPellet_input <- ASHP_WoodPellet_backup_heating/wood_pellet_efficiency
full_NG_input <- heating_load/naturalgas_furnace_efficiency
full_HO_input <- heating_load/heatingoil_furnace_efficiency
full_P_input <- heating_load/propane_furnace_efficiency
full_ElecRes_input <- heating_load/ElecRes_efficiency
full_WoodCord_input <- heating_load/wood_cord_efficiency
full_WoodPellet_input <- heating_load/wood_pellet_efficiency
###other variables
social_cost_of_CO2 <- runif(1, min = 14, max = 51)/1000 #dollars per kg of CO2
##### we assume that methane leakage per production rates will remain constant
##### over time. We also assume that all fuel burned whether for heating or
##### electricity production is from the U.S. and not imported.
## account for methane leakage in the natural gas and oil production cycle
# estimated amount of produced methane that leaks during the natural gas production cycle
# source: https://www-science-org.ezproxy.library.wisc.edu/doi/10.1126/science.aar7204
# the paper provides 95% confidence interval of 2 to 2.7 with a mean of 2.3. They don't
# give any information on the distribution used and it is clearly not symmetric, but
# our best estimation is a normal distribution. The code below essentially splits the
# difference and finds the standard deviation of a normal distribution with a mean of
# 2.3 and a low of 1.95 and high of 2.65.
sd <- (abs((2 - 2.3)/1.96) + abs((2.7 - 2.3)/1.96))/2
NG_and_Petroleum_methane_leakage_rate <- rnorm(1, 2.3, sd)/100
full_NG_methane_leak_CO2e <- methane_leak(full_NG_input, NG_and_Petroleum_methane_leakage_rate,
mmBTU_per_cubic_ft_NG, cubic_ft_NG_to_kg)
full_HO_methane_leak_CO2e <- methane_leak(full_HO_input, NG_and_Petroleum_methane_leakage_rate,
mmBTU_per_gallon_HO, gallon_HO_to_kg)
full_P_methane_leak_CO2e <- methane_leak(full_P_input, NG_and_Petroleum_methane_leakage_rate,
mmBTU_per_gallon_P, gallon_P_to_kg)
backup_NG_methane_leak_CO2e <- methane_leak(backup_NG_input, NG_and_Petroleum_methane_leakage_rate,
mmBTU_per_cubic_ft_NG, cubic_ft_NG_to_kg)
backup_HO_methane_leak_CO2e <- methane_leak(backup_HO_input, NG_and_Petroleum_methane_leakage_rate,
mmBTU_per_gallon_HO, gallon_HO_to_kg)
backup_P_methane_leak_CO2e <- methane_leak(backup_P_input, NG_and_Petroleum_methane_leakage_rate,
mmBTU_per_gallon_P, gallon_P_to_kg)
## create dataset to track the 15 year simulation for this trial
track_years <- track_years <- data.frame(n = c(0:years_of_analysis))
#### input year 0 costs (i.e. installation costs)
track_years[track_years$n == 0,"NG"] <- naturalgas_furnace_installment_cost
track_years[track_years$n == 0,"HO"] <- heatingoil_furnace_installment_cost
track_years[track_years$n == 0,"P"] <- propane_furnace_installment_cost
track_years[track_years$n == 0, "ElecRes"] <- ElecRes_installment_cost
track_years[track_years$n == 0, "WoodCord"] <- wood_cord_installment_cost
track_years[track_years$n == 0, "WoodPellet"] <- wood_pellet_installment_cost
track_years[track_years$n == 0, "AC"] <- AC_installment_cost
track_years[track_years$n == 0,"ASHP_NG"] <- naturalgas_furnace_installment_cost +
ASHP_installment_cost
track_years[track_years$n == 0,"ASHP_HO"] <- heatingoil_furnace_installment_cost +
ASHP_installment_cost
track_years[track_years$n == 0,"ASHP_P"] <- propane_furnace_installment_cost +
ASHP_installment_cost
track_years[track_years$n == 0,"ASHP_ElecRes"] <- ElecRes_installment_cost +
ASHP_installment_cost
track_years[track_years$n == 0,"ASHP_WoodCord"] <- wood_cord_installment_cost +
ASHP_installment_cost
track_years[track_years$n == 0,"ASHP_WoodPellet"] <- wood_pellet_installment_cost +
ASHP_installment_cost
#### start simulation of annual costs ####
for(j in 1:years_of_analysis){
###cost variables
#fuel cost in 2021 $/mmBTU from EIA projections for year j
heating_electricity_price <- heating_electricity_cost*fuel_cost_growth_rates[j, which(str_detect(colnames(fuel_cost_growth_rates), "Electricity"))]
naturalgas_price <- projections[j, which(str_detect(colnames(fuel_cost_growth_rates), "Gas"))]
heatingoil_price <- projections[j, which(str_detect(colnames(projections), "Oil"))]
propane_price <- projections[j, which(str_detect(colnames(projections), "Propane"))]
### emissions variables
# accounts for the fact that the grid gets cleaner every year at a linear rate
electricity_CO2_use <- electricity_CO2*(1-decarb*(j+1))
electricity_CH4_use <- electricity_CH4*(1-decarb*(j+1))
electricity_N2O_use <- electricity_N2O*(1-decarb*(j+1))
### lifecycle calculations
proportion_electricity_from_coal <- proportion_electricity_from_coal - drop_in_coal
proportion_electricity_from_wind <- proportion_electricity_from_wind + drop_in_coal/2
proportion_electricity_from_solar <- proportion_electricity_from_solar + drop_in_coal/2
### lifecycle emissions for electricity (not including combustion below)
# kg of CO2e per kWh of electricity
electricity_lifecycle <- biomass_lifecycle*proportion_electricity_from_biomass +
photovoltaic_lifecycle*proportion_electricity_from_solar +
hydro_lifecycle*proportion_electricity_from_hydro +
wind_lifecycle*proportion_electricity_from_wind +
nuclear_lifecycle*proportion_electricity_from_nuclear +
NG_lifecycle*proportion_electricity_from_NG +
oil_lifecycle*proportion_electricity_from_oil +
coal_lifecycle*proportion_electricity_from_coal
# convert to kg of CO2e per mmBTU to add to the combustion value below
mmBTU_per_kWh <- 3412/1000000 #source: https://www.eia.gov/energyexplained/units-and-calculators/
electricity_lifecycle <- electricity_lifecycle*mmBTU_per_kWh
################# convert variables to standard units ###################
##carbon dioxide equivalents of emissions in kg per mmBTU
#electricity
lb_to_kg <- .45359237 #source: https://www.metric-conversions.org/weight/pounds-to-kilograms.htm
electricity_CO2e <- (electricity_CO2_use*GWP_CO2 + electricity_CH4_use*GWP_CH4 +
electricity_N2O_use*GWP_N2O)*lb_to_kg/(mmBTU_per_kWh*1000) +
electricity_lifecycle
#nat gas
## multiply each emission by the emissions global warming potential and add to get CO2 equivalents
naturalgas_CO2e <- naturalgas_CO2*GWP_CO2 + naturalgas_CH4*GWP_CH4 + naturalgas_N2O*GWP_N2O
#heating oil
heatingoil_CO2e <- heatingoil_CO2*GWP_CO2 + heatingoil_CH4*GWP_CH4 + heatingoil_N2O*GWP_N2O
#propane
propane_CO2e <- propane_CO2*GWP_CO2 + propane_CH4*GWP_CH4 + propane_N2O*GWP_N2O
#wood cords
wood_CO2e <- wood_CO2*GWP_CO2 + wood_CH4*GWP_CH4 + wood_N2O*GWP_N2O
############### end of conversions ########################################
################# Calculations section ###############
####Calculate heating costs for all heating types
ASHP_NG_fuel_cost <- ASHP_NG_input*heating_electricity_price
ASHP_HO_fuel_cost <- ASHP_HO_input*heating_electricity_price
ASHP_P_fuel_cost <- ASHP_P_input*heating_electricity_price
ASHP_ElecRes_fuel_cost <- ASHP_ElecRes_input*heating_electricity_price
ASHP_WoodCord_fuel_cost <- ASHP_WoodCord_input*wood_cord_cost
ASHP_WoodPellet_fuel_cost <- ASHP_WoodPellet_input*wood_pellet_cost
backup_naturalgas_fuel_cost <-  backup_NG_input*naturalgas_price
backup_heatingoil_fuel_cost <- backup_HO_input*heatingoil_price
backup_propane_fuel_cost <- backup_P_input*propane_price
backup_ElecRes_fuel_cost <- backup_ElecRes_input*heating_electricity_price
backup_WoodCord_fuel_cost <- backup_WoodCord_input*wood_cord_cost
backup_WoodPellet_fuel_cost <- backup_WoodPellet_input*wood_pellet_cost
full_naturalgas_fuel_cost <- full_NG_input*naturalgas_price
full_heatingoil_fuel_cost <- full_HO_input*heatingoil_price
full_propane_fuel_cost <- full_P_input*propane_price
full_ElecRes_fuel_cost <- full_ElecRes_input*heating_electricity_price
full_WoodCord_fuel_cost <- full_WoodCord_input*wood_cord_cost
full_WoodPellet_fuel_cost <- full_WoodPellet_input*wood_pellet_cost
# all electric emissions account for line loss, the % of electricity lost
# from production to end-source. Since producers account for line-loss in their
# production output (e.g. if they expect a demand of 1 kWh they know to produce
# 1 * (1 + lineloss) kWh of electricity) the end user who demanded that electricity
# is responsible for the line loss as well.
line_loss <- 0.05
#### Calculate emissions for all heating types and monetize with social carbon costs
cooling_emissions_cost <- (cooling_kWh*mmBTU_per_kWh*electricity_CO2e)*
(1+line_loss)*social_cost_of_CO2
ASHP_NG_emissions_cost <- (ASHP_NG_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
ASHP_HO_emissions_cost <- (ASHP_HO_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
ASHP_P_emissions_cost <- (ASHP_P_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
ASHP_ElecRes_emissions_cost <- (ASHP_ElecRes_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
ASHP_WoodCord_emissions_cost <- (ASHP_WoodCord_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
ASHP_WoodPellet_emissions_cost <- (ASHP_WoodPellet_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
backup_naturalgas_emissions_cost <- (backup_NG_input*naturalgas_CO2e +
backup_NG_methane_leak_CO2e)*social_cost_of_CO2
backup_heatingoil_emissions_cost <- (backup_HO_input*heatingoil_CO2e +
backup_HO_methane_leak_CO2e)*social_cost_of_CO2
backup_propane_emissions_cost <- (backup_P_input*propane_CO2e +
backup_P_methane_leak_CO2e)*social_cost_of_CO2
backup_ElecRes_emissions_cost <- (backup_ElecRes_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
backup_WoodCord_emissions_cost <- (backup_WoodCord_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
backup_WoodPellet_emissions_cost <- (backup_WoodPellet_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
full_natgas_emissions_cost <- (full_NG_input*naturalgas_CO2e +
full_NG_methane_leak_CO2e)*social_cost_of_CO2
full_heatingoil_emissions_cost <- (full_HO_input*heatingoil_CO2e +
full_HO_methane_leak_CO2e)*social_cost_of_CO2
full_propane_emissions_cost <- (full_P_input*propane_CO2e +
full_P_methane_leak_CO2e)*social_cost_of_CO2
full_ElecRes_emissions_cost <- (full_ElecRes_input*electricity_CO2e)*(1+line_loss)*
social_cost_of_CO2
full_WoodCord_emissions_cost <- (full_WoodCord_input*wood_CO2e)*social_cost_of_CO2
full_WoodPellet_emissions_cost <- (full_WoodPellet_input*wood_CO2e)*social_cost_of_CO2
################### End of "calculation section" ################
######################## NPV ####################################
## calculate this years costs
NG <- full_natgas_emissions_cost + full_naturalgas_fuel_cost
HO <- full_heatingoil_emissions_cost + full_heatingoil_fuel_cost
P <- full_propane_emissions_cost + full_propane_fuel_cost
ElecRes <- full_ElecRes_emissions_cost + full_ElecRes_fuel_cost
WoodCord <- full_WoodCord_emissions_cost + full_WoodCord_fuel_cost
WoodPellet <- full_WoodPellet_emissions_cost + full_WoodPellet_fuel_cost
AC <- cooling_emissions_cost
ASHP_NG <- ASHP_NG_fuel_cost + ASHP_NG_emissions_cost +
backup_naturalgas_emissions_cost + backup_naturalgas_fuel_cost + cooling_emissions_cost
ASHP_HO <- ASHP_HO_fuel_cost + ASHP_HO_emissions_cost +
backup_heatingoil_emissions_cost + backup_heatingoil_fuel_cost + cooling_emissions_cost
ASHP_P <- ASHP_P_fuel_cost + ASHP_P_emissions_cost +
backup_propane_emissions_cost + backup_propane_fuel_cost + cooling_emissions_cost
ASHP_ElecRes <- ASHP_ElecRes_fuel_cost + ASHP_ElecRes_emissions_cost +
backup_ElecRes_emissions_cost + backup_ElecRes_fuel_cost + cooling_emissions_cost
ASHP_WoodCord <- ASHP_WoodCord_fuel_cost + ASHP_WoodCord_emissions_cost +
backup_WoodCord_emissions_cost + backup_WoodCord_fuel_cost + cooling_emissions_cost
ASHP_WoodPellet <- ASHP_WoodPellet_fuel_cost + ASHP_WoodPellet_emissions_cost +
backup_WoodPellet_emissions_cost + backup_WoodPellet_fuel_cost + cooling_emissions_cost
## discount the annual costs to derive the NPV
track_years[track_years$n == j, "NG"] <- NG/(1+discount_rate)^j
track_years[track_years$n == j, "HO"] <- HO/(1+discount_rate)^j
track_years[track_years$n == j, "P"] <- P/(1+discount_rate)^j
track_years[track_years$n == j, "ElecRes"] <- ElecRes/(1+discount_rate)^j
track_years[track_years$n == j, "WoodCord"] <- WoodCord/(1+discount_rate)^j
track_years[track_years$n == j, "WoodPellet"] <- WoodPellet/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_NG"] <- ASHP_NG/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_HO"] <- ASHP_HO/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_P"] <- ASHP_P/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_ElecRes"] <- ASHP_ElecRes/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_WoodCord"] <- ASHP_WoodCord/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_WoodPellet"] <- ASHP_WoodPellet/(1+discount_rate)^j
track_years[track_years$n == j, "AC"] <- AC/(1+discount_rate)^j
## sub-parts of the net benefits
#### Maintenance and Operations costs
track_years[track_years$n == j, "NG_MO"] <-
full_naturalgas_fuel_cost/(1+discount_rate)^j
track_years[track_years$n == j, "HO_MO"] <-
full_heatingoil_fuel_cost/(1+discount_rate)^j
track_years[track_years$n == j, "P_MO"] <-
full_propane_fuel_cost/(1+discount_rate)^j
track_years[track_years$n == j, "ElecRes_MO"] <-
full_ElecRes_fuel_cost/(1+discount_rate)^j
track_years[track_years$n == j, "WoodCord_MO"] <-
full_WoodCord_fuel_cost/(1+discount_rate)^j
track_years[track_years$n == j, "WoodPellet_MO"] <-
full_WoodPellet_fuel_cost/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_NG_MO"] <-
(ASHP_NG_fuel_cost + backup_naturalgas_fuel_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_HO_MO"] <-
(ASHP_HO_fuel_cost + backup_heatingoil_fuel_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_P_MO"] <-
(ASHP_P_fuel_cost + backup_propane_fuel_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_ElecRes_MO"] <-
(ASHP_ElecRes_fuel_cost + backup_ElecRes_fuel_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_WoodCord_MO"] <-
(ASHP_WoodCord_fuel_cost + backup_WoodCord_fuel_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_WoodPellet_MO"] <-
(ASHP_WoodPellet_fuel_cost + backup_WoodPellet_fuel_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "AC_MO"] <- 0
#### emissions costs
track_years[track_years$n == j, "NG_emissions_cost"] <-
full_natgas_emissions_cost/(1+discount_rate)^j
track_years[track_years$n == j, "HO_emissions_cost"] <-
full_heatingoil_emissions_cost/(1+discount_rate)^j
track_years[track_years$n == j, "P_emissions_cost"] <-
full_propane_emissions_cost/(1+discount_rate)^j
track_years[track_years$n == j, "ElecRes_emissions_cost"] <-
full_ElecRes_emissions_cost/(1+discount_rate)^j
track_years[track_years$n == j, "WoodCord_emissions_cost"] <-
full_WoodCord_emissions_cost/(1+discount_rate)^j
track_years[track_years$n == j, "WoodPellet_emissions_cost"] <-
full_WoodPellet_emissions_cost/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_NG_emissions_cost"] <-
(ASHP_NG_emissions_cost + backup_naturalgas_emissions_cost + cooling_emissions_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_HO_emissions_cost"] <-
(ASHP_HO_emissions_cost + backup_heatingoil_emissions_cost + cooling_emissions_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_P_emissions_cost"] <-
(ASHP_P_emissions_cost + backup_propane_emissions_cost + cooling_emissions_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_ElecRes_emissions_cost"] <-
(ASHP_ElecRes_emissions_cost + backup_ElecRes_emissions_cost + cooling_emissions_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_WoodCord_emissions_cost"] <-
(ASHP_WoodCord_emissions_cost + backup_WoodCord_emissions_cost + cooling_emissions_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "ASHP_WoodPellet_emissions_cost"] <-
(ASHP_WoodPellet_emissions_cost + backup_WoodPellet_emissions_cost + cooling_emissions_cost)/(1+discount_rate)^j
track_years[track_years$n == j, "AC_emissions_cost"] <- cooling_emissions_cost/(1+discount_rate)^j
######################### end of "NPV" section ####################
}
track_years[is.na(track_years)] <- 0
## at the end of the 15 years, we then take the sum of the annual NPVs to find
## the total NPV
track_trials[i, "NG"] <- sum(track_years$NG)
track_trials[i, "HO"] <- sum(track_years$HO)
track_trials[i, "P"] <- sum(track_years$P)
track_trials[i, "ElecRes"] <- sum(track_years$ElecRes)
track_trials[i, "WoodCord"] <- sum(track_years$WoodCord)
track_trials[i, "WoodPellet"] <- sum(track_years$WoodPellet)
track_trials[i, "ASHP_NG"] <- sum(track_years$ASHP_NG)
track_trials[i, "ASHP_HO"] <- sum(track_years$ASHP_HO)
track_trials[i, "ASHP_P"] <- sum(track_years$ASHP_P)
track_trials[i, "ASHP_ElecRes"] <- sum(track_years$ASHP_ElecRes)
track_trials[i, "ASHP_WoodCord"] <- sum(track_years$ASHP_WoodCord)
track_trials[i, "ASHP_WoodPellet"] <- sum(track_years$ASHP_WoodPellet)
track_trials[i, "AC"] <- sum(track_years$AC)
##subparts
## capital
track_trials[i, "NG_capital"] <- track_years[1,"NG"]
track_trials[i, "HO_capital"] <- track_years[1,"HO"]
track_trials[i, "P_capital"] <- track_years[1,"P"]
track_trials[i, "ElecRes_capital"] <- track_years[1,"ElecRes"]
track_trials[i, "WoodCord_capital"] <- track_years[1,"WoodCord"]
track_trials[i, "WoodPellet_capital"] <- track_years[1,"WoodPellet"]
track_trials[i, "ASHP_NG_capital"] <- track_years[1,"ASHP_NG"]
track_trials[i, "ASHP_HO_capital"] <- track_years[1,"ASHP_HO"]
track_trials[i, "ASHP_P_capital"] <- track_years[1,"ASHP_P"]
track_trials[i, "ASHP_ElecRes_capital"] <- track_years[1,"ASHP_ElecRes"]
track_trials[i, "ASHP_WoodCord_capital"] <- track_years[1,"ASHP_WoodCord"]
track_trials[i, "ASHP_WoodPellet_capital"] <- track_years[1,"ASHP_WoodPellet"]
track_trials[i, "AC_capital"] <- track_years[1,"AC"]
## M&O
track_trials[i, "NG_MO"] <- sum(track_years$NG_MO)
track_trials[i, "HO_MO"] <- sum(track_years$HO_MO)
track_trials[i, "P_MO"] <- sum(track_years$P_MO)
track_trials[i, "ElecRes_MO"] <- sum(track_years$ElecRes_MO)
track_trials[i, "WoodCord_MO"] <- sum(track_years$WoodCord_MO)
track_trials[i, "WoodPellet_MO"] <- sum(track_years$WoodPellet_MO)
track_trials[i, "ASHP_NG_MO"] <- sum(track_years$ASHP_NG_MO)
track_trials[i, "ASHP_HO_MO"] <- sum(track_years$ASHP_HO_MO)
track_trials[i, "ASHP_P_MO"] <- sum(track_years$ASHP_P_MO)
track_trials[i, "ASHP_ElecRes_MO"] <- sum(track_years$ASHP_ElecRes_MO)
track_trials[i, "ASHP_WoodCord_MO"] <- sum(track_years$ASHP_WoodCord_MO)
track_trials[i, "ASHP_WoodPellet_MO"] <- sum(track_years$ASHP_WoodPellet_MO)
track_trials[i, "AC_MO"] <- 0
#### emissions costs
track_trials[i, "NG_emissions_cost"] <- sum(track_years$NG_emissions_cost)
track_trials[i, "HO_emissions_cost"] <- sum(track_years$HO_emissions_cost)
track_trials[i, "P_emissions_cost"] <- sum(track_years$P_emissions_cost)
track_trials[i, "ElecRes_emissions_cost"] <- sum(track_years$ElecRes_emissions_cost)
track_trials[i, "WoodCord_emissions_cost"] <- sum(track_years$WoodCord_emissions_cost)
track_trials[i, "WoodPellet_emissions_cost"] <- sum(track_years$WoodPellet_emissions_cost)
track_trials[i, "ASHP_NG_emissions_cost"] <- sum(track_years$ASHP_NG_emissions_cost)
track_trials[i, "ASHP_HO_emissions_cost"] <- sum(track_years$ASHP_HO_emissions_cost)
track_trials[i, "ASHP_P_emissions_cost"] <- sum(track_years$ASHP_P_emissions_cost)
track_trials[i, "ASHP_ElecRes_emissions_cost"] <- sum(track_years$ASHP_ElecRes_emissions_cost)
track_trials[i, "ASHP_WoodCord_emissions_cost"] <- sum(track_years$ASHP_WoodCord_emissions_cost)
track_trials[i, "ASHP_WoodPellet_emissions_cost"] <- sum(track_years$ASHP_WoodPellet_emissions_cost)
track_trials[i, "AC_emissions_cost"] <- sum(track_years$AC_emissions_cost)
#### emissions
track_trials[i, "NG_emissions"] <- sum(track_years$NG_emissions_cost)/social_cost_of_CO2
track_trials[i, "HO_emissions"] <- sum(track_years$HO_emissions_cost)/social_cost_of_CO2
track_trials[i, "P_emissions"] <- sum(track_years$P_emissions_cost)/social_cost_of_CO2
track_trials[i, "ElecRes_emissions"] <- sum(track_years$ElecRes_emissions_cost)/social_cost_of_CO2
track_trials[i, "WoodCord_emissions"] <- sum(track_years$WoodCord_emissions_cost)/social_cost_of_CO2
track_trials[i, "WoodPellet_emissions"] <- sum(track_years$WoodPellet_emissions_cost)/social_cost_of_CO2
track_trials[i, "ASHP_NG_emissions"] <- sum(track_years$ASHP_NG_emissions_cost)/social_cost_of_CO2
track_trials[i, "ASHP_HO_emissions"] <- sum(track_years$ASHP_HO_emissions_cost)/social_cost_of_CO2
track_trials[i, "ASHP_P_emissions"] <- sum(track_years$ASHP_P_emissions_cost)/social_cost_of_CO2
track_trials[i, "ASHP_ElecRes_emissions"] <- sum(track_years$ASHP_ElecRes_emissions_cost)/social_cost_of_CO2
track_trials[i, "ASHP_WoodCord_emissions"] <- sum(track_years$ASHP_WoodCord_emissions_cost)/social_cost_of_CO2
track_trials[i, "ASHP_WoodPellet_emissions"] <- sum(track_years$ASHP_WoodPellet_emissions_cost)/social_cost_of_CO2
track_trials[i, "AC_emissions"] <- sum(track_years$AC_emissions_cost)/social_cost_of_CO2
}
geo[k, "heating_load"] <- heating_load
geo[k, "cooling_load"] <- cooling_kWh
geo[k,"NG_cool_NB"] <- mean(track_trials$ASHP_NG) - (mean(track_trials$NG) + mean(track_trials$AC))
geo[k,"NG_cool_NB_capital"] <- mean(track_trials$ASHP_NG_capital) - (mean(track_trials$NG_capital) + mean(track_trials$AC_capital))
geo[k,"NG_cool_NB_MO"] <- mean(track_trials$ASHP_NG_MO) - (mean(track_trials$NG_MO) + mean(track_trials$AC_MO))
geo[k,"NG_cool_NB_emissions"] <- mean(track_trials$ASHP_NG_emissions_cost) - (mean(track_trials$NG_emissions_cost) + mean(track_trials$AC_emissions_cost))
geo[k,"NG_cool_private"] <- geo[k,"NG_cool_NB_capital"] + geo[k,"NG_cool_NB_MO"]
geo[k,"NG_cool_CO2e"] <- mean(track_trials$ASHP_NG_emissions) - (mean(track_trials$NG_emissions) + mean(track_trials$AC_emissions))
geo[k,"NG_nocool_NB"] <- mean(track_trials$ASHP_NG) - mean(track_trials$NG)
geo[k,"NG_nocool_NB_capital"] <- mean(track_trials$ASHP_NG_capital) - mean(track_trials$NG_capital)
geo[k,"NG_nocool_NB_MO"] <- mean(track_trials$ASHP_NG_MO) - mean(track_trials$NG_MO)
geo[k,"NG_nocool_NB_emissions"] <- mean(track_trials$ASHP_NG_emissions_cost) - mean(track_trials$NG_emissions_cost)
geo[k,"NG_nocool_private"] <- geo[k,"NG_nocool_NB_capital"] + geo[k,"NG_nocool_NB_MO"]
geo[k,"NG_nocool_CO2e"] <- mean(track_trials$ASHP_NG_emissions) - mean(track_trials$NG_emissions)
geo[k,"HO_cool_NB"] <- mean(track_trials$ASHP_HO) - (mean(track_trials$HO) + mean(track_trials$AC))
geo[k,"HO_cool_NB_capital"] <- mean(track_trials$ASHP_HO_capital) - (mean(track_trials$HO_capital) + mean(track_trials$AC_capital))
geo[k,"HO_cool_NB_MO"] <- mean(track_trials$ASHP_HO_MO) - (mean(track_trials$HO_MO) + mean(track_trials$AC_MO))
geo[k,"HO_cool_NB_emissions"] <- mean(track_trials$ASHP_HO_emissions_cost) - (mean(track_trials$HO_emissions_cost) + mean(track_trials$AC_emissions_cost))
geo[k,"HO_cool_private"] <- geo[k,"HO_cool_NB_capital"] + geo[k,"HO_cool_NB_MO"]
geo[k,"HO_cool_CO2e"] <- mean(track_trials$ASHP_HO_emissions) - (mean(track_trials$HO_emissions) + mean(track_trials$AC_emissions))
geo[k,"HO_nocool_NB"] <- mean(track_trials$ASHP_HO) - mean(track_trials$HO)
geo[k,"HO_nocool_NB_capital"] <- mean(track_trials$ASHP_HO_capital) - mean(track_trials$HO_capital)
geo[k,"HO_nocool_NB_MO"] <- mean(track_trials$ASHP_HO_MO) - mean(track_trials$HO_MO)
geo[k,"HO_nocool_NB_emissions"] <- mean(track_trials$ASHP_HO_emissions_cost) - mean(track_trials$HO_emissions_cost)
geo[k,"HO_nocool_private"] <- geo[k,"HO_nocool_NB_capital"] + geo[k,"HO_nocool_NB_MO"]
geo[k,"HO_nocool_CO2e"] <- mean(track_trials$ASHP_HO_emissions) - mean(track_trials$HO_emissions)
geo[k,"P_cool_NB"] <- mean(track_trials$ASHP_P) - (mean(track_trials$P) + mean(track_trials$AC))
geo[k,"P_cool_NB_capital"] <- mean(track_trials$ASHP_P_capital) - (mean(track_trials$P_capital) + mean(track_trials$AC_capital))
geo[k,"P_cool_NB_MO"] <- mean(track_trials$ASHP_P_MO) - (mean(track_trials$P_MO) + mean(track_trials$AC_MO))
geo[k,"P_cool_NB_emissions"] <- mean(track_trials$ASHP_P_emissions_cost) - (mean(track_trials$P_emissions_cost) + mean(track_trials$AC_emissions_cost))
geo[k,"P_cool_private"] <- geo[k,"P_cool_NB_capital"] + geo[k,"P_cool_NB_MO"]
geo[k,"P_cool_CO2e"] <- mean(track_trials$ASHP_P_emissions) - (mean(track_trials$P_emissions) + mean(track_trials$AC_emissions))
geo[k,"P_nocool_NB"] <- mean(track_trials$ASHP_P) - mean(track_trials$P)
geo[k,"P_nocool_NB_capital"] <- mean(track_trials$ASHP_P_capital) - mean(track_trials$P_capital)
geo[k,"P_nocool_NB_MO"] <- mean(track_trials$ASHP_P_MO) - mean(track_trials$P_MO)
geo[k,"P_nocool_NB_emissions"] <- mean(track_trials$ASHP_P_emissions_cost) - mean(track_trials$P_emissions_cost)
geo[k,"P_nocool_private"] <- geo[k,"P_nocool_NB_capital"] + geo[k,"P_nocool_NB_MO"]
geo[k,"P_nocool_CO2e"] <- mean(track_trials$ASHP_P_emissions) - mean(track_trials$P_emissions)
geo[k,"ElecRes_cool_NB"] <- mean(track_trials$ASHP_ElecRes) - (mean(track_trials$ElecRes) + mean(track_trials$AC))
geo[k,"ElecRes_cool_NB_capital"] <- mean(track_trials$ASHP_ElecRes_capital) - (mean(track_trials$ElecRes_capital) + mean(track_trials$AC_capital))
geo[k,"ElecRes_cool_NB_MO"] <- mean(track_trials$ASHP_ElecRes_MO) - (mean(track_trials$ElecRes_MO) + mean(track_trials$AC_MO))
geo[k,"ElecRes_cool_NB_emissions"] <- mean(track_trials$ASHP_ElecRes_emissions_cost) - (mean(track_trials$ElecRes_emissions_cost) + mean(track_trials$AC_emissions_cost))
geo[k,"ElecRes_cool_private"] <- geo[k,"ElecRes_cool_NB_capital"] + geo[k,"ElecRes_cool_NB_MO"]
geo[k,"ElecRes_cool_CO2e"] <- mean(track_trials$ASHP_ElecRes_emissions) - (mean(track_trials$ElecRes_emissions) + mean(track_trials$AC_emissions))
geo[k,"ElecRes_nocool_NB"] <- mean(track_trials$ASHP_ElecRes) - mean(track_trials$ElecRes)
geo[k,"ElecRes_nocool_NB_capital"] <- mean(track_trials$ASHP_ElecRes_capital) - mean(track_trials$ElecRes_capital)
geo[k,"ElecRes_nocool_NB_MO"] <- mean(track_trials$ASHP_ElecRes_MO) - mean(track_trials$ElecRes_MO)
geo[k,"ElecRes_nocool_NB_emissions"] <- mean(track_trials$ASHP_ElecRes_emissions_cost) - mean(track_trials$ElecRes_emissions_cost)
geo[k,"ElecRes_nocool_private"] <- geo[k,"ElecRes_nocool_NB_capital"] + geo[k,"ElecRes_nocool_NB_MO"]
geo[k,"ElecRes_nocool_CO2e"] <- mean(track_trials$ASHP_ElecRes_emissions) - mean(track_trials$ElecRes_emissions)
geo[k,"wood_cool_NB"] <- (mean(track_trials$ASHP_WoodCord) + mean(track_trials$ASHP_WoodPellet))/2 - ((mean(track_trials$WoodCord) + mean(track_trials$WoodPellet))/2  + mean(track_trials$AC))
geo[k,"wood_cool_NB_capital"] <- (mean(track_trials$ASHP_WoodCord_capital) + mean(track_trials$ASHP_WoodPellet_capital))/2 - ((mean(track_trials$WoodCord_capital) + mean(track_trials$WoodPellet_capital))/2  + mean(track_trials$AC_capital))
geo[k,"wood_cool_NB_MO"] <- (mean(track_trials$ASHP_WoodCord_MO) + mean(track_trials$ASHP_WoodPellet_MO))/2 - ((mean(track_trials$WoodCord_MO) + mean(track_trials$WoodPellet_MO))/2  + mean(track_trials$AC_MO))
geo[k,"wood_cool_NB_emissions"] <- (mean(track_trials$ASHP_WoodCord_emissions_cost) + mean(track_trials$ASHP_WoodPellet_emissions_cost))/2 - ((mean(track_trials$WoodCord_emissions_cost) + mean(track_trials$WoodPellet_emissions_cost))/2  + mean(track_trials$AC_emissions_cost))
geo[k,"wood_cool_private"] <- geo[k,"wood_cool_NB_capital"] + geo[k,"wood_cool_NB_MO"]
geo[k,"wood_cool_CO2e"] <- (mean(track_trials$ASHP_WoodCord_emissions) + mean(track_trials$ASHP_WoodPellet_emissions))/2 - ((mean(track_trials$WoodCord_emissions) + mean(track_trials$WoodPellet_emissions))/2  + mean(track_trials$AC_emissions))
geo[k,"wood_nocool_NB"] <- (mean(track_trials$ASHP_WoodCord) + mean(track_trials$ASHP_WoodPellet))/2 - ((mean(track_trials$WoodCord) + mean(track_trials$WoodPellet))/2 )
geo[k,"wood_nocool_NB_capital"] <- (mean(track_trials$ASHP_WoodCord_capital) + mean(track_trials$ASHP_WoodPellet_capital))/2 - ((mean(track_trials$WoodCord_capital) + mean(track_trials$WoodPellet_capital))/2 )
geo[k,"wood_nocool_NB_MO"] <- (mean(track_trials$ASHP_WoodCord_MO) + mean(track_trials$ASHP_WoodPellet_MO))/2 - ((mean(track_trials$WoodCord_MO) + mean(track_trials$WoodPellet_MO))/2)
geo[k,"wood_nocool_NB_emissions"] <- (mean(track_trials$ASHP_WoodCord_emissions_cost) + mean(track_trials$ASHP_WoodPellet_emissions_cost))/2 - ((mean(track_trials$WoodCord_emissions_cost) + mean(track_trials$WoodPellet_emissions_cost))/2)
geo[k,"wood_nocool_private"] <- geo[k,"wood_nocool_NB_capital"] + geo[k,"wood_nocool_NB_MO"]
geo[k,"wood_nocool_CO2e"] <- (mean(track_trials$ASHP_WoodCord_emissions) + mean(track_trials$ASHP_WoodPellet_emissions))/2 - ((mean(track_trials$WoodCord_emissions) + mean(track_trials$WoodPellet_emissions))/2)
geo[k,c(127:ncol(geo))] <- geo[k,c(127:ncol(geo))]*-1
View(geo)
geo[k,"perc_positive_NB_NG_cool"] <- mean((track_trials$ASHP_NG - (track_trials$NG + track_trials$AC)) < 0)
geo[k,"perc_positive_private_NG_cool"] <- mean(((track_trials$ASHP_NG_capital + track_trials$ASHP_NG_MO) - (track_trials$NG_capital + track_trials$AC_capital + track_trials$NG_MO + track_trials$AC_MO)) < 0)
geo[k,"perc_positive_NB_NG_nocool"] <- mean((track_trials$ASHP_NG - track_trials$NG) < 0)
geo[k,"perc_positive_private_NG_nocool"] <- mean(((track_trials$ASHP_NG_capital + track_trials$ASHP_NG_MO) - (track_trials$NG_capital + track_trials$NG_MO)) < 0)
geo[k,"perc_positive_NB_P_cool"] <- mean((track_trials$ASHP_P - (track_trials$P + track_trials$AC)) < 0)
geo[k,"perc_positive_private_P_cool"] <- mean(((track_trials$ASHP_P_capital + track_trials$ASHP_P_MO) - (track_trials$P_capital + track_trials$AC_capital + track_trials$P_MO + track_trials$AC_MO)) < 0)
geo[k,"perc_positive_NB_P_nocool"] <- mean((track_trials$ASHP_P - track_trials$P) < 0)
geo[k,"perc_positive_private_P_nocool"] <- mean(((track_trials$ASHP_P_capital + track_trials$ASHP_P_MO) - (track_trials$P_capital + track_trials$P_MO)) < 0)
geo[k,"perc_positive_NB_HO_cool"] <- mean((track_trials$ASHP_HO - (track_trials$HO + track_trials$AC)) < 0)
geo[k,"perc_positive_private_HO_cool"] <- mean(((track_trials$ASHP_HO_capital + track_trials$ASHP_HO_MO) - (track_trials$HO_capital + track_trials$AC_capital + track_trials$HO_MO + track_trials$AC_MO)) < 0)
geo[k,"perc_positive_NB_HO_nocool"] <- mean((track_trials$ASHP_HO - track_trials$HO) < 0)
geo[k,"perc_positive_private_HO_nocool"] <- mean(((track_trials$ASHP_HO_capital + track_trials$ASHP_HO_MO) - (track_trials$HO_capital + track_trials$HO_MO)) < 0)
geo[k,"perc_positive_NB_ElecRes_cool"] <- mean((track_trials$ASHP_ElecRes - (track_trials$ElecRes + track_trials$AC)) < 0)
geo[k,"perc_positive_private_ElecRes_cool"] <- mean(((track_trials$ASHP_ElecRes_capital + track_trials$ASHP_ElecRes_MO) - (track_trials$ElecRes_capital + track_trials$AC_capital + track_trials$ElecRes_MO + track_trials$AC_MO)) < 0)
geo[k,"perc_positive_NB_ElecRes_nocool"] <- mean((track_trials$ASHP_ElecRes - track_trials$ElecRes) < 0)
geo[k,"perc_positive_private_ElecRes_nocool"] <- mean(((track_trials$ASHP_ElecRes_capital + track_trials$ASHP_ElecRes_MO) - (track_trials$ElecRes_capital + track_trials$ElecRes_MO)) < 0)
geo[k,"perc_positive_NB_wood_cool"] <- mean(((track_trials$ASHP_WoodCord + track_trials$ASHP_WoodPellet)/2 - ((track_trials$WoodCord_capital + track_trials$WoodPellet_capital)/2 + track_trials$AC)) < 0)
geo[k,"perc_positive_private_wood_cool"] <- mean((((track_trials$ASHP_WoodCord_capital + track_trials$ASHP_WoodPellet_capital)/2 + (track_trials$ASHP_WoodCord_MO + track_trials$ASHP_WoodPellet_MO)/2) - ((track_trials$WoodCord_capital + track_trials$WoodPellet_capital)/2 + track_trials$AC_capital + (track_trials$WoodCord_MO + track_trials$WoodPellet_MO)/2 + track_trials$AC_MO)) < 0)
geo[k,"perc_positive_NB_wood_nocool"] <- mean(((track_trials$ASHP_WoodCord + track_trials$ASHP_WoodPellet)/2 - ((track_trials$WoodCord_capital + track_trials$WoodPellet_capital)/2)) < 0)
geo[k,"perc_positive_private_wood_nocool"] <- mean((((track_trials$ASHP_WoodCord_capital + track_trials$ASHP_WoodPellet_capital)/2 + (track_trials$ASHP_WoodCord_MO + track_trials$ASHP_WoodPellet_MO)/2) - ((track_trials$WoodCord_capital + track_trials$WoodPellet_capital)/2 + (track_trials$WoodCord_MO + track_trials$WoodPellet_MO)/2)) < 0)
geo[k,"perc_positive_NB_wood_cool"] <- mean(((track_trials$ASHP_WoodCord + track_trials$ASHP_WoodPellet)/2 - ((track_trials$WoodCord + track_trials$WoodPellet)/2 + track_trials$AC)) < 0)
geo[k,"perc_positive_private_wood_cool"] <- mean((((track_trials$ASHP_WoodCord_capital + track_trials$ASHP_WoodPellet_capital)/2 + (track_trials$ASHP_WoodCord_MO + track_trials$ASHP_WoodPellet_MO)/2) - ((track_trials$WoodCord_capital + track_trials$WoodPellet_capital)/2 + track_trials$AC_capital + (track_trials$WoodCord_MO + track_trials$WoodPellet_MO)/2 + track_trials$AC_MO)) < 0)
geo[k,"perc_positive_NB_wood_nocool"] <- mean(((track_trials$ASHP_WoodCord + track_trials$ASHP_WoodPellet)/2 - ((track_trials$WoodCord + track_trials$WoodPellet)/2)) < 0)
geo[k,"perc_positive_private_wood_nocool"] <- mean((((track_trials$ASHP_WoodCord_capital + track_trials$ASHP_WoodPellet_capital)/2 + (track_trials$ASHP_WoodCord_MO + track_trials$ASHP_WoodPellet_MO)/2) - ((track_trials$WoodCord_capital + track_trials$WoodPellet_capital)/2 + (track_trials$WoodCord_MO + track_trials$WoodPellet_MO)/2)) < 0)
