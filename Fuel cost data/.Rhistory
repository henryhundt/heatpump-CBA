#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) tr:nth-child(3) td:nth-child(3)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) tr:nth-child(3) td:nth-child(3)")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(2) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(4) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(5) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(2) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) th , tr:nth-child(3) .ng-binding")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
remDr$findElement(using = "css", value = "tr:nth-child(11) th , tr:nth-child(11) .ng-binding")$getElementText()
## SEER
remDr$findElement(using = "css", value = "tr:nth-child(11) .ng-binding")$getElementText()
## SEER
remDr$findElement(using = "css", value = "tr:nth-child(12) .ng-binding")$getElementText()
remDr$navigate("https://ashp.neep.org/#!/product/56995")
remDr$findElement(using = "css", value = "tr:nth-child(3) td")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
## ducting configuration
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(2)")$getElementText()
## SEER
remDr$findElement(using = "css", value = "tr:nth-child(11) .ng-binding")$getElementText()
## HSPF
remDr$findElement(using = "css", value = "tr:nth-child(12) .ng-binding")$getElementText()
#first section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(2) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = "tr:nth-child(3) td:nth-child(3)")$getElementText()
#second section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(3) tr:nth-child(3) td:nth-child(3)")$getElementText()
#third section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(4) tr:nth-child(3) td:nth-child(3)")$getElementText()
#fourth section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) td:nth-child(6)")$getElementText()
#rated COP
remDr$findElement(using = "css", value = ".ng-scope:nth-child(5) tr:nth-child(3) td:nth-child(3)")$getElementText()
#fifth section
#rated output
remDr$findElement(using = "css", value = ".ng-scope:nth-child(6) td:nth-child(6)")$getElementText()
49%%50
50%%50
library(RSelenium)
library(stringr)
library(rvest)
library(dplyr)
wisconsin_zip <- c(53001:54990)
costs <- data.frame(zipcode = 0, totalcost_low = 0, totalcost_high = 0, systemcost_low = 0,
systemcost_high = 0, laborcost_low = 0, laborcost_high = 0,
jobsupplycost_low = 0, jobsupplycost_high = 0, equipmentallowance_low = 0,
equipmentallowance_high = 0)
i <- 1
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 1:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
Sys.sleep(5)
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(1)
#Sys.sleep(5)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
#Sys.sleep(5)
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
#Sys.sleep(5)
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
#Sys.sleep(5)
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
#Sys.sleep(5)
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
#Sys.sleep(5)
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
#Sys.sleep(5)
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) write.csv(costs, "temp.csv", row.names = F)
}
costs
write.csv(costs, "temp.csv", row.names = F)
test <- apply(df,2,as.character)
test <- apply(costs,2,as.character)
View(test)
test <- as.data.frame(apply(costs,2,as.character))
View(test)
write.csv(test, "temp.csv", row.names = F)
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 51:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
Sys.sleep(5)
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(1)
#Sys.sleep(5)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
#Sys.sleep(5)
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
#Sys.sleep(5)
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
#Sys.sleep(5)
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
#Sys.sleep(5)
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
#Sys.sleep(5)
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
#Sys.sleep(5)
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
remDr$close()
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 737:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
Sys.sleep(5)
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(1)
#Sys.sleep(5)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
#Sys.sleep(5)
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
#Sys.sleep(5)
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
#Sys.sleep(5)
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
#Sys.sleep(5)
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
#Sys.sleep(5)
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
#Sys.sleep(5)
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
for(i in 888:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(3)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
print(zip)
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
for(i in 906:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
View(costs)
for(i in 906:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
test
View(test)
for(i in 1230:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
rD <- rsDriver(port = 4445L, browser = "chrome")
remDr <- rD$client
remDr$navigate("https://www.homewyse.com")
remDr$navigate("https://www.homewyse.com/services/cost_to_install_heat_pump.html")
for(i in 1230:length(wisconsin_zip)){
zip <- wisconsin_zip[i]
costs[i,]$zipcode <- zip
remDr$findElement(using = "css", value = '#postcode5')$sendKeysToElement(list("\u0008", "\u0008", "\u0008", "\u0008", "\u0008", as.character(zip), key = "enter"))
remDr$findElement(using = "css", value = "#button1")$click()
Sys.sleep(2)
totalcost_low <- remDr$findElement(using = "css", value = "#s1")$getElementText()
totalcost_high <- remDr$findElement(using = "css", value = "#s2")$getElementText()
systemcost_low <- remDr$findElement(using = "css", value = ".low_val")$getElementText()
systemcost_high <- remDr$findElement(using = "css", value = ".hi_val")$getElementText()
laborcost <- str_extract_all(remDr$findElement(using = "css", value = "#r1")$getElementText(), "[$0-9],[0-9]+")
jobsupplycost <- str_extract_all(remDr$findElement(using = "css", value = "#r2")$getElementText(), "[/$0-9][0-9]+")
equipmentallowance <- str_extract_all(remDr$findElement(using = "css", value = "#r3")$getElementText(), "[/$0-9][0-9]+")
costs[i,]$totalcost_low <- totalcost_low
costs[i,]$totalcost_high <- totalcost_high
costs[i,]$systemcost_low <- systemcost_low
costs[i,]$systemcost_high <- systemcost_high
costs[i,]$laborcost_low <- laborcost[[1]][1]
costs[i,]$laborcost_high <- laborcost[[1]][2]
costs[i,]$jobsupplycost_low <- jobsupplycost[[1]][1]
costs[i,]$jobsupplycost_high <- jobsupplycost[[1]][2]
costs[i,]$equipmentallowance_low <- equipmentallowance[[1]][1]
costs[i,]$equipmentallowance_high <- equipmentallowance[[1]][2]
print(zip)
if(i%%50 == 0) {
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "temp.csv", row.names = F)
}
}
test <- as.data.frame(apply(costs,2,as.character))
write.csv(test, "cost to install heat pump - default.csv", row.names = F)
remDr$close()
setwd("~/Desktop/ENV 810/Data/Fuel cost data")
library(readxl)
dir()
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx"")
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx")
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx")
View(df)
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4)
View(df)
library(dplyr)
which(df[,1] == "Residential Space Heat")
place <- which(df[,1] == "Residential Space Heat")
place <- which(df[,1] == "Residential Space Heat") + 1
hold <- df[c(place:(place + 13))]
hold <- df[c(place:(place + 13)),]
View(hold)
hold <- df[c(1, place:(place + 13)),]
View(hold)
final <- data.frame()
for(i in 2:31){
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
place <- which(df[,1] == "Residential Space Heat") + 1
df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)
}
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
View(df)
place
for(i in 2:31){
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
}
i <- 1
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
View(df)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
final <- data.frame()
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
i <- 2
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
View(df)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
i <- 3
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
View(df)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
i <- 4
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", skip = 4, sheet = i)
View(df)
i
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = i)
View(df)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
final <- data.frame()
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = i)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
View(df)
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = i, col_names = F)
View(final)
final <- data.frame()
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
View(final)
seq(from = 4, to = 28, by = 4)
for(i in seq(from = 4, to = 28, by = 4)){
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = i, col_names = F)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
}
View(final)
final <- data.frame()
for(i in seq(from = 4, to = 28, by = 4)){
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = i, col_names = F)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
}
View(final)
read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = 1)
variables <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = 1)
variables[4,]
variables[3,]
final <- final[,c(1:13)]
colnames(final) <- c("Year", "Month", "Utility.Code", "Customer.Class", "Revenue($)", "Use(Therms)","Customers")
final <- final[,c(1:13)]
final <- data.frame()
for(i in seq(from = 4, to = 28, by = 4)){
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = i, col_names = F)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
}
final <- final[,c(1:7)]
colnames(final) <- c("Year", "Month", "Utility.Code", "Customer.Class", "Revenue($)", "Use(Therms)","Customers")
colnames(final) <- c("Year", "Month", "Utility.Code", "Customer.Class", "Revenue", "Therms","Customers")
final$Revenue <- final$Revenue*1000
final$Therms <- final$Therms*1000
utilities <- filter(final, str_detect(Year, "="))
library(stringr)
utilities <- filter(final, str_detect(Year, "="))
final <- filter(final, !str_detect(Year, "="))
View(utilities)
final <- data.frame()
for(i in seq(from = 4, to = 28, by = 4)){
df <- read_xlsx("AF2_May2020_June2021 (1)-converted.xlsx", sheet = i, col_names = F)
place <- which(df[,1] == "Residential Space Heat") + 1
if(length(place) > 0){df <- df[c(1, place:(place + 13)),]
final <- rbind(final, df)}
}
final <- final[,c(1:7)]
colnames(final) <- c("Year", "Month", "Utility.Code", "Customer.Class", "Revenue", "Therms","Customers")
final$Revenue <- final$Revenue*1000
final$Therms <- final$Therms*1000
utilities <- filter(final, str_detect(Year, "="))
str_remove_all(utilities$Year,"[0-9]+ = ")
utilities$Year <- str_remove_all(utilities$Year,"[0-9]+ = ")
utilities <- filter(final, str_detect(Year, "="))
utilities$utility <- str_remove_all(utilities$Year,"[0-9]+ = ")
str_remove_all(utilities$Year," = .+")
utilities$Utility.Code <- str_remove_all(utilities$Year," = .+")
utilities <- select(utilities, utility, Utility.Code)
final <- filter(final, !str_detect(Year, "="))
final <- left_join(final, utilities, by = "Utility.Code")
utilities$Utility.Code <- as.double(utilities$Utility.Code)
final <- left_join(final, utilities, by = "Utility.Code")
write.csv("nat. gas cost, 5-20 to 6-21, no coops")
write.csv(final, "nat. gas cost, 5-20 to 6-21, no coops", row.names = F)
write.csv(final, "nat. gas cost, 5-20 to 6-21, no coops.csv", row.names = F)
